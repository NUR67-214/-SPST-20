<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>แบบประเมินความเครียด (SPST-20) | Stress Check</title>
<meta name="description" content="ประเมินความเครียดของคุณตอนนี้ด้วย SPST-20 พร้อมคำแนะนำคลายเครียด และแบบประเมินความพึงพอใจ" />
<style>
:root{
--bg:#e3f0fc; /* ฟ้าอ่อน */
--card:#ffffff;
--ink:#111827;
--muted:#6b7280;
--brand:#2563eb;
--brand-ink:#fff;
--ok:#16a34a;
--warn:#f59e0b;
--bad:#dc2626;
--ring: 0 0 0 3px rgba(37,99,235,.25);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,TH Sarabun New,Leelawadee,K2D,sans-serif;background:var(--bg);color:var(--ink);}
.wrap{max-width:980px;margin:0 auto;padding:24px}
header{display:flex;align-items:center;gap:16px;margin-bottom:16px}
.logo-img{width:56px;height:56px;border-radius:16px;background:#fff;display:grid;place-items:center;}
.logo-img img{width:48px;height:48px;display:block;}
h1{font-size:clamp(20px,3vw,28px);margin:0}
.card{background:var(--card);border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.04);}
.stage{padding:24px}
.muted{color:var(--muted)}
.btns{display:flex;gap:12px;flex-wrap:wrap;margin-top:20px}
button,.btn{appearance:none;border:0;padding:12px 16px;border-radius:12px;cursor:pointer;font-weight:600}
.primary{background:var(--brand);color:var(--brand-ink)}
.ghost{background:#eef2ff;color:#1e3a8a}
.subtle{background:#f3f4f6}
button:focus-visible{outline:none;box-shadow:var(--ring)}
.progress{height:8px;background:#e5e7eb;border-radius:999px;overflow:hidden;margin:16px 24px}
.bar{height:100%;width:0;background:linear-gradient(90deg,#60a5fa,#2563eb);transition:width .4s ease}
.grid{display:grid;gap:16px}
@media(min-width:720px){ .grid-2{grid-template-columns:1fr 1fr} }
.pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:12px}
.q{padding:12px 14px;border:1px solid #e5e7eb;border-radius:12px}
.q h4{margin:0 0 8px 0;font-size:16px}
.scale{display:flex;gap:10px;flex-wrap:wrap}
.scale label{display:inline-flex;align-items:center;gap:6px;padding:8px 10px;border:1px solid #e5e7eb;border-radius:10px;cursor:pointer}
input[type="radio"]{accent-color:#2563eb}
.result{padding:14px;border-radius:12px;border:1px dashed #d1d5db;background:#f9fafb}
.chipset{display:flex;gap:12px;flex-wrap:wrap}
.chip{width:140px;aspect-ratio:1/1;border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;border:2px solid #e5e7eb;background:#fff;cursor:pointer;text-align:center;padding:12px}
.chip:focus-visible{outline:none;box-shadow:var(--ring)}
.chip svg{width:28px;height:28px;margin-bottom:8px}
.circle-breathe{width:220px;height:220px;border-radius:50%;border:6px solid #93c5fd;margin:20px auto;display:grid;place-items:center;transition:transform 4s ease}
.label-center{text-align:center;font-weight:600}
.stars{display:flex;gap:6px;font-size:28px;cursor:pointer}
.stars button{background:transparent;font-size:28px;line-height:1}
.hide{display:none !important}
.note{color:var(--bad);background:#fff0f0;padding:10px 16px;border-radius:8px;margin-bottom:12px;}
footer{margin-top:24px;font-size:12px}
.tag-ok{color:var(--ok)} .tag-warn{color:var(--warn)} .tag-bad{color:var(--bad)}
</style>
</head>
<body>
<div class="wrap">
<header aria-label="หัวเว็บ">
<div class="logo-img">
<img src="stress-logo.png" alt="โลโก้สุขภาพจิต" />
</div>
<div>
<h1>แบบประเมินความเครียด (SPST-20) • Stress Check</h1>
<div class="muted">รู้ระดับความเครียดของคุณตอนนี้ พร้อมคำแนะนำคลายเครียดอย่างปลอดภัย</div>
</div>
</header>

<div class="card">
<div class="progress"><div id="bar" class="bar"></div></div>

<!-- Stage 1: Intro -->
<section class="stage" data-step="1">
<p class="pill">หน้าแรก</p>
<h2>ประเมินความเครียดของคุณตอนนี้เลย</h2>
<p class="muted">เครื่องมือ: แบบวัดความเครียด กรมสุขภาพจิต (SPST-20)</p>
<div class="btns">
<button class="primary" id="startBtn">เริ่มทำแบบประเมิน</button>
</div>
</section>

<!-- Stage 2: Instruction -->
<section class="stage hide" data-step="2">
<p class="pill">คำชี้แจง</p>
<h3>แบบวัดความเครียด กรมสุขภาพจิต (SPST-20)</h3>
<div class="note">
<strong>หมายเหตุ:</strong> <br>
<span>ต้องตอบครบทั้ง <strong>20 ข้อ</strong>จึงจะสามารถคำนวณผลได้ หากตอบไม่ครบจะไม่มีการประเมินคะแนน</span>
</div>
<p>ในระยะ <strong>6 เดือนที่ผ่านมา</strong> หากเหตุการณ์ในข้อใดเกิดขึ้นกับคุณ และคุณรู้สึกอย่างไรต่อเหตุการณ์นั้น ให้เลือกระดับความเครียด 1–5 ของข้อนั้น <em>(ห้ามข้าม ต้องตอบทุกข้อ)</em></p>
<ul>
<li>1 = ไม่รู้สึกเครียด</li>
<li>2 = เครียดเล็กน้อย</li>
<li>3 = เครียดปานกลาง</li>
<li>4 = เครียดมาก</li>
<li>5 = เครียดมากที่สุด</li>
</ul>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" data-nav="next">เริ่มทำข้อคำถาม</button>
</div>
</section>

<!-- Stage 3: Questionnaire -->
<section class="stage hide" data-step="3" aria-live="polite">
<p class="pill">แบบประเมิน 20 ข้อ</p>
<div class="note">
<strong>หมายเหตุ:</strong> ต้องตอบครบทุกข้อก่อนถึงจะคำนวณและแปลผลได้
</div>
<div id="questions" class="grid"></div>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" id="calcBtn">คำนวณคะแนน & แปลผล</button>
</div>
<div id="scoreBox" class="result hide" role="status" aria-live="polite"></div>
</section>

<!-- Stage 4: Manage stress options -->
<section class="stage hide" data-step="4">
<p class="pill">แนวทางคลายเครียด</p>
<h3>เลือกวิธีที่อยากลองตอนนี้</h3>
<div class="chipset" role="listbox" aria-label="เลือกกิจกรรม">
<button class="chip" data-choice="music" aria-label="ฟังเพลง">
<svg viewBox="0 0 24 24" fill="none"><path d="M9 18V5l11-2v13" stroke="currentColor" stroke-width="2"/><circle cx="7" cy="18" r="3" stroke="currentColor" stroke-width="2"/><circle cx="18" cy="16" r="3" stroke="currentColor" stroke-width="2"/></svg>
<div>ฟังเพลง</div>
</button>
<button class="chip" data-choice="breath" aria-label="ทำสมาธิ ฝึกหายใจ">
<svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="M8 12h8M12 8v8" stroke="currentColor" stroke-width="2"/></svg>
<div>ทำสมาธิ-ฝึกหายใจ</div>
</button>
<button class="chip" data-choice="game" aria-label="เล่นเกมสั้นๆ">
<svg viewBox="0 0 24 24" fill="none"><rect x="3" y="7" width="18" height="10" rx="3" stroke="currentColor" stroke-width="2"/><circle cx="9" cy="12" r="1" fill="currentColor"/><circle cx="15" cy="12" r="1" fill="currentColor"/></svg>
<div>เล่นเกม</div>
</button>
<button class="chip" data-choice="video" aria-label="วิดีโอผ่อนคลาย">
<svg viewBox="0 0 24 24" fill="none"><rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2"/><path d="M10 9l6 3-6 3V9z" fill="currentColor"/></svg>
<div>วิดีโอผ่อนคลาย</div>
</button>
<button class="chip" data-choice="crisis" aria-label="เครียดรุนแรง ติดต่อด่วน">
<svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 7v6" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="17" r="1.5" fill="currentColor"/></svg>
<div>เครียดรุนแรง</div>
</button>
</div>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" id="goChoice" disabled>ถัดไป</button>
</div>
<div id="crisisInfo" class="result hide">
<strong>ต้องการความช่วยเหลือด่วน?</strong>
<ul>
<li>สายด่วนสุขภาพจิต <strong>1323</strong> (ฟรี 24 ชม.) – กรมสุขภาพจิต</li>
<li>สายด่วน <strong>1669</strong> (การแพทย์ฉุกเฉิน)</li>
<li>ช่องทางออนไลน์ <strong>LINE</strong> และ <strong>Facebook Fanpage 1323</strong> <a href="https://www.facebook.com/helpline1323/?locale=th_TH" target="_blank">ดูรายละเอียด</a></li>
</ul>
<div class="muted" style="margin-top:8px;">
<strong>หมายเหตุ:</strong> หากมีความเสี่ยง หรือมีอันตรายต่อชีวิต กรุณาติดต่อสายด่วนทันที
</div>
</div>
</section>

<!-- Stage 5: Show chosen method -->
<section class="stage hide" data-step="5">
<p class="pill">เริ่มคลายเครียด</p>
<div id="methodPane"></div>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" data-nav="next">ถัดไป</button>
</div>
</section>

<!-- Stage 6: Satisfaction survey (10 items) -->
<section class="stage hide" data-step="6">
<p class="pill">แบบประเมินความพึงพอใจ</p>
<p>โปรดประเมินความพึงพอใจต่อประสบการณ์ใช้งาน (1 = น้อยมาก … 5 = มากที่สุด)</p>
<div id="satQs" class="grid"></div>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" data-nav="next">ถัดไป</button>
</div>
</section>

<!-- Stage 7: Suggestions + star rating -->
<section class="stage hide" data-step="7">
<p class="pill">ข้อเสนอแนะ</p>
<label for="feedback">มีอะไรอยากให้ปรับปรุง/เพิ่มเติมบ้าง?</label>
<textarea id="feedback" rows="5" style="width:100%;margin-top:8px;border-radius:10px;border:1px solid #e5e7eb;padding:10px"></textarea>
<div style="margin-top:14px">
ให้คะแนนโดยรวม:
<div class="stars" role="radiogroup" aria-label="ให้ดาว">
<button data-star="1" aria-label="1 ดาว">☆</button>
<button data-star="2" aria-label="2 ดาว">☆</button>
<button data-star="3" aria-label="3 ดาว">☆</button>
<button data-star="4" aria-label="4 ดาว">☆</button>
<button data-star="5" aria-label="5 ดาว">☆</button>
</div>
</div>
<div class="btns">
<button class="subtle" data-nav="back">ย้อนกลับ</button>
<button class="primary" data-nav="next">ถัดไป</button>
</div>
</section>

<!-- Stage 8: Thank you -->
<section class="stage hide" data-step="8">
<p class="pill">เสร็จสิ้น</p>
<h2>ขอบคุณสำหรับการทำแบบประเมิน 💙</h2>
<p class="muted">คุณสามารถบันทึกผลไว้ใช้อ้างอิงส่วนตัว หรือเริ่มทำใหม่ได้ทุกเมื่อ</p>
<div id="summaryOut" class="result"></div>
<div class="btns">
<button class="ghost" id="restart">เริ่มใหม่อีกครั้ง</button>
</div>
</section>
</div>

<footer class="muted">
อ้างอิง: เกณฑ์แปลผลและข้อคำถาม SPST-20 จากเอกสารของกรมสุขภาพจิต/โรงพยาบาลสวนปรุง; ช่องทางช่วยเหลือ 1323 และหน่วยงานที่เกี่ยวข้อง; หลักฐานเชิงวิจัยเรื่องการฝึกหายใจเพื่อลดความเครียด (มีผลต่อระบบประสาทพาราซิมพาเทติก) และแนวทางพัฒนาแบบลิเคิร์ต 5 ระดับ (Likert). แหล่งที่มาแนบท้ายหน้านี้
</footer>
</div>

<script>
// ---------- App state ----------
const state = { step:1, answers:{}, score:0, interp:"", choice:null, sat:{}, stars:0, feedback:"" };
const stepsTotal = 8;
const bar = document.getElementById('bar');

function setStep(n){
  state.step = n;
  document.querySelectorAll('.stage').forEach(el=>{
    el.classList.toggle('hide', +el.dataset.step !== n);
  });
  bar.style.width = ((n-1)/(stepsTotal-1))*100 + '%';
  window.scrollTo({top:0, behavior:'smooth'});
}

document.getElementById('startBtn').addEventListener('click',()=>setStep(2));
document.querySelectorAll('[data-nav]').forEach(btn=>{
  btn.addEventListener('click', e=>{
    const dir = e
